<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/avatar.jpeg"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.ico"><link rel="mask-icon" href="/images/avatar.jpeg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free@6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous"><link rel="stylesheet" href="https://unpkg.com/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"yuerer.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.21.1","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"hide","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":true,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="https://s4.zstatic.net/ajax/libs/hexo-theme-next/8.21.1/config.min.js"></script><meta name="description" content="文件系统和文件 文件系统是操作系统中管理持久性数据的子系统 提供数据存储和访问功能 文件是具有符号名 由字节序列构成的数据项集合 文件是文件系统的基本数据单位 文件名是文件的标识符号"><meta property="og:type" content="article"><meta property="og:title" content="操作系统之 文件系统"><meta property="og:url" content="https://yuerer.com/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/index.html"><meta property="og:site_name" content="Yuerer&#39;s Blog"><meta property="og:description" content="文件系统和文件 文件系统是操作系统中管理持久性数据的子系统 提供数据存储和访问功能 文件是具有符号名 由字节序列构成的数据项集合 文件是文件系统的基本数据单位 文件名是文件的标识符号"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://yuerer.com/images/Hierarchical_File_System.png"><meta property="og:image" content="https://yuerer.com/images/Alias.png"><meta property="og:image" content="https://yuerer.com/images/Directory_Loop.png"><meta property="og:image" content="https://yuerer.com/images/Mounting_File_Systems.png"><meta property="og:image" content="https://yuerer.com/images/File_system_implementation.png"><meta property="og:image" content="https://yuerer.com/images/File_system_organization.png"><meta property="og:image" content="https://yuerer.com/images/File_system_storage.png"><meta property="og:image" content="https://yuerer.com/images/Disk_cache.png"><meta property="og:image" content="https://yuerer.com/images/Data_Block_cache.png"><meta property="og:image" content="https://yuerer.com/images/Page_cache_0.png"><meta property="og:image" content="https://yuerer.com/images/Page_cache_1.png"><meta property="og:image" content="https://yuerer.com/images/Open_file_table.png"><meta property="og:image" content="https://yuerer.com/images/Continuous_Allocation.png"><meta property="og:image" content="https://yuerer.com/images/Linked_Allocation.png"><meta property="og:image" content="https://yuerer.com/images/Indexed_Allocation.png"><meta property="og:image" content="https://yuerer.com/images/Link_Index_Allocation.png"><meta property="og:image" content="https://yuerer.com/images/Multilevel_Index_Allocation.png"><meta property="og:image" content="https://yuerer.com/images/Unix_file_system.png"><meta property="og:image" content="https://yuerer.com/images/Disk_partitioning.png"><meta property="og:image" content="https://yuerer.com/images/RAID_0.png"><meta property="og:image" content="https://yuerer.com/images/RAID_1.png"><meta property="og:image" content="https://yuerer.com/images/RAID_4.png"><meta property="og:image" content="https://yuerer.com/images/RAID_5.png"><meta property="og:image" content="https://yuerer.com/images/RAID_0+1.png"><meta property="og:image" content="https://yuerer.com/images/RAID_1+0.png"><meta property="article:published_time" content="2019-01-13T01:50:20.000Z"><meta property="article:modified_time" content="2025-10-21T13:50:52.274Z"><meta property="article:author" content="Yuerer"><meta property="article:tag" content="操作系统"><meta property="article:tag" content="文件系统"><meta property="article:tag" content="冗余磁盘阵列"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://yuerer.com/images/Hierarchical_File_System.png"><link rel="canonical" href="https://yuerer.com/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://yuerer.com/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/","path":"操作系统之-文件系统/","title":"操作系统之 文件系统"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>操作系统之 文件系统 | Yuerer's Blog</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-129491388-1"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-129491388-1","only_pageview":false,"measure_protocol_api_secret":null}</script><script src="https://s4.zstatic.net/ajax/libs/hexo-theme-next/8.21.1/third-party/analytics/google-analytics.min.js"></script><link rel="dns-prefetch" href="https://yuerer-comment-xufei-0bea01e6f05-1307930306.ap-shanghai.app.tcloudbase.com"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Yuerer's Blog</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">钰儿的Blog</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li></ul></nav></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%92%8C%E6%96%87%E4%BB%B6"><span class="nav-text">文件系统和文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="nav-text">文件系统的功能</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7"><span class="nav-text">文件属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%A4%B4"><span class="nav-text">文件头</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="nav-text">文件描述符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%9A%84%E7%94%A8%E6%88%B7%E8%A7%86%E5%9B%BE%E5%92%8C%E7%B3%BB%E7%BB%9F%E8%A7%86%E5%9B%BE"><span class="nav-text">文件的用户视图和系统视图</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E8%A7%86%E5%9B%BE%E5%88%B0%E7%B3%BB%E7%BB%9F%E8%A7%86%E5%9B%BE%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="nav-text">用户视图到系统视图的转换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E6%A8%A1%E5%BC%8F"><span class="nav-text">访问模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84"><span class="nav-text">文件内部结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB%E5%92%8C%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="nav-text">文件共享和访问控制</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%AD%E4%B9%89%E4%B8%80%E8%87%B4%E6%80%A7"><span class="nav-text">语义一致性</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E5%B1%82%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">分层文件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C"><span class="nav-text">目录操作</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E5%AE%9E%E7%8E%B0"><span class="nav-text">目录实现</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%88%AB%E5%90%8D"><span class="nav-text">文件别名</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84%E5%BE%AA%E7%8E%AF"><span class="nav-text">文件目录中的循环</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%8D%E5%AD%97%E8%A7%A3%E6%9E%90-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86"><span class="nav-text">名字解析(路径遍历)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8C%82%E8%BD%BD"><span class="nav-text">文件系统挂载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%A7%8D%E7%B1%BB"><span class="nav-text">文件系统种类</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C-%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">网络&#x2F;分布式文件系统</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0"><span class="nav-text">文件系统实现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%99%9A%E6%8B%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F-VFS"><span class="nav-text">虚拟文件系统(VFS)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-text">文件系统基本数据结构</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%84%E7%BB%87%E8%A7%86%E5%9B%BE"><span class="nav-text">文件系统的组织视图</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84"><span class="nav-text">文件系统的存储结构</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AD%98%E5%82%A8%E8%A7%86%E5%9B%BE"><span class="nav-text">文件系统的存储视图</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E7%A7%8D%E7%A3%81%E7%9B%98%E7%BC%93%E5%AD%98%E4%BD%8D%E7%BD%AE"><span class="nav-text">多种磁盘缓存位置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%A4%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%9D%97%E7%BC%93%E5%AD%98%E6%96%B9%E5%BC%8F"><span class="nav-text">两种数据块缓存方式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%9D%97%E7%BC%93%E5%AD%98"><span class="nav-text">数据块缓存</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%A1%B5%E7%BC%93%E5%AD%98"><span class="nav-text">页缓存</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B8%AD%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-text">文件系统中打开文件的数据结构</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E9%94%81"><span class="nav-text">打开文件锁</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F"><span class="nav-text">文件大小</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%88%86%E9%85%8D"><span class="nav-text">文件分配</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9E%E7%BB%AD%E5%88%86%E9%85%8D"><span class="nav-text">连续分配</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%93%BE%E5%BC%8F%E5%88%86%E9%85%8D"><span class="nav-text">链式分配</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E5%88%86%E9%85%8D"><span class="nav-text">索引分配</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%A7%E6%96%87%E4%BB%B6%E7%9A%84%E7%B4%A2%E5%BC%95%E5%88%86%E9%85%8D"><span class="nav-text">大文件的索引分配</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#UFS%E5%A4%9A%E7%BA%A7%E7%B4%A2%E5%BC%95%E5%88%86%E9%85%8D-UFS-Unix-File-System"><span class="nav-text">UFS多级索引分配(UFS Unix File System)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86"><span class="nav-text">空闲空间管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%8D%E5%9B%BE-%E7%BB%84%E7%BB%87%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4"><span class="nav-text">位图 组织空闲空间</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="nav-text">磁盘分区</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86"><span class="nav-text">多磁盘管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%97%E4%BD%99%E7%A3%81%E7%9B%98%E9%98%B5%E5%88%97-RAID-Redundant-Array-of-Inexpensive-Disks"><span class="nav-text">冗余磁盘阵列(RAID Redundant Array of Inexpensive Disks)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%97%E4%BD%99%E7%A3%81%E7%9B%98%E9%98%B5%E5%88%97%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-text">冗余磁盘阵列的实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RAID-0-%E7%A3%81%E7%9B%98%E6%9D%A1%E5%B8%A6%E5%8C%96"><span class="nav-text">RAID-0(磁盘条带化)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RAID-1-%E7%A3%81%E7%9B%98%E9%95%9C%E5%83%8F"><span class="nav-text">RAID-1(磁盘镜像)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RAID-4-%E5%B8%A6%E6%A0%A1%E9%AA%8C%E7%9A%84%E7%A3%81%E7%9B%98%E6%9D%A1%E5%B8%A6%E5%8C%96"><span class="nav-text">RAID-4(带校验的磁盘条带化)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RAID-5-%E5%B8%A6%E5%88%86%E5%B8%83%E5%BC%8F%E6%A0%A1%E9%AA%8C%E7%9A%84%E7%A3%81%E7%9B%98%E6%9D%A1%E5%B8%A6%E5%8C%96"><span class="nav-text">RAID-5(带分布式校验的磁盘条带化)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%AF%E7%BA%A0%E6%AD%A3%E5%A4%9A%E4%B8%AA%E7%A3%81%E7%9B%98%E9%94%99%E8%AF%AF%E7%9A%84%E5%86%97%E4%BD%99%E7%A3%81%E7%9B%98%E9%98%B5%E5%88%97"><span class="nav-text">可纠正多个磁盘错误的冗余磁盘阵列</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#RAID%E5%B5%8C%E5%A5%97"><span class="nav-text">RAID嵌套</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Yuerer" src="/images/avatar.jpeg"><p class="site-author-name" itemprop="name">Yuerer</p><div class="site-description" itemprop="description">钰儿的Blog</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">65</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">90</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Yu2erer" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Yu2erer" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:yu2erer#gmail.com" title="E-Mail → mailto:yu2erer#gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://yuerer.com/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpeg"><meta itemprop="name" content="Yuerer"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Yuerer's Blog"><meta itemprop="description" content="钰儿的Blog"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="操作系统之 文件系统 | Yuerer's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">操作系统之 文件系统</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-01-13 09:50:20" itemprop="dateCreated datePublished" datetime="2019-01-13T09:50:20+08:00">2019-01-13</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a> </span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Waline：</span> <a title="waline" href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" itemprop="commentCount"></span> </a></span><span class="post-meta-item" title="阅读次数"><span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span class="waline-pageview-count" data-path="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"></span></span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="文件系统和文件"><a href="#文件系统和文件" class="headerlink" title="文件系统和文件"></a>文件系统和文件</h2><ul><li>文件系统是操作系统中管理持久性数据的子系统 提供数据存储和访问功能</li><li>文件是具有符号名 由字节序列构成的数据项集合<ul><li>文件是文件系统的基本数据单位</li><li>文件名是文件的标识符号</li></ul></li></ul><span id="more"></span><h3 id="文件系统的功能"><a href="#文件系统的功能" class="headerlink" title="文件系统的功能"></a>文件系统的功能</h3><ul><li>分配文件磁盘空间<ul><li>管理文件块(位置和顺序)</li><li>管理空闲空间(位置)</li><li>分配算法(策略)</li></ul></li><li>管理文件集合<ul><li>定位 文件及其内容</li><li>命名 通过名字找到文件</li><li>文件系统结构 文件组织方式</li></ul></li><li>数据可靠和安全<ul><li>安全 多层次保护数据安全</li><li>可靠 持久保存文件 避免系统崩溃 攻击</li></ul></li></ul><h4 id="文件属性"><a href="#文件属性" class="headerlink" title="文件属性"></a>文件属性</h4><p>名称 类型 位置 大小 保护 创建者 创建时间 最近修改时间</p><h4 id="文件头"><a href="#文件头" class="headerlink" title="文件头"></a>文件头</h4><p>文件系统元数据中的文件信息</p><ul><li>文件属性</li><li>文件存储位置和顺序</li></ul><h3 id="文件描述符"><a href="#文件描述符" class="headerlink" title="文件描述符"></a>文件描述符</h3><p>操作系统在打开文件表中维护的打开文件状态和信息</p><ul><li>文件指针<ul><li>最近一次读写位置</li><li>每个进程分别维护自己的打开文件指针</li></ul></li><li>文件打开计数<ul><li>当前打开文件的次数</li><li>最后一个进程关闭文件时 将其从打开文件表中移除</li></ul></li><li>文件的磁盘位置<ul><li>缓存数据访问信息</li></ul></li><li>访问权限<ul><li>每个进程的文件访问模式信息</li></ul></li></ul><h3 id="文件的用户视图和系统视图"><a href="#文件的用户视图和系统视图" class="headerlink" title="文件的用户视图和系统视图"></a>文件的用户视图和系统视图</h3><ul><li>文件的用户视图<ul><li>持久的数据结构</li></ul></li><li>系统访问接口<ul><li>字节序列的集合(Unix)</li><li>系统不关心存储在磁盘上的数据结构</li></ul></li><li>操作系统的文件视图<ul><li>数据块的集合</li><li>数据块是逻辑存储单元 而扇区是物理存储单元</li><li>块大小和扇区大小通常是不同的 通常是几个扇区构成一个数据块</li></ul></li></ul><h4 id="用户视图到系统视图的转换"><a href="#用户视图到系统视图的转换" class="headerlink" title="用户视图到系统视图的转换"></a>用户视图到系统视图的转换</h4><p>文件系统中的基本操作单位是数据块 <code>getc()和putc()</code>即使每次只访问1字节的数据 也需要缓存目标数据4096字节</p><ul><li>进程读文件<ul><li>获取字节所在的数据块(数据块是逻辑存储单位)</li><li>返回数据块内对应部分</li></ul></li><li>进程写文件<ul><li>获取数据块</li><li>修改数据块中对应部分</li><li>写回数据块</li></ul></li></ul><h4 id="访问模式"><a href="#访问模式" class="headerlink" title="访问模式"></a>访问模式</h4><p>操作系统需要了解进程如何访问文件</p><ul><li>顺序访问<ul><li>按字节依次读取</li><li>大多数文件访问都是顺序访问</li></ul></li><li>随机访问<ul><li>从中间读写</li><li>不常用 但很重要</li><li>虚拟内存中把内存页存储在文件</li></ul></li><li>索引访问<ul><li>依据数据特征索引</li><li>通常操作系统不完整提供索引访问</li><li>数据库是建立在索引内容的磁盘访问之上</li></ul></li></ul><h4 id="文件内部结构"><a href="#文件内部结构" class="headerlink" title="文件内部结构"></a>文件内部结构</h4><ul><li>无结构<ul><li>单词 字节序列</li></ul></li><li>简单记录结构<ul><li>分列</li><li>固定长度</li><li>可变长度</li></ul></li><li>复杂结构<ul><li>格式化的文档(PDF Word)</li><li>可执行文件</li></ul></li></ul><h4 id="文件共享和访问控制"><a href="#文件共享和访问控制" class="headerlink" title="文件共享和访问控制"></a>文件共享和访问控制</h4><p>多用户系统中的文件共享是很有必要的</p><ul><li>访问控制<ul><li>每个用户能够获得哪些文件的哪些访问权限</li><li>访问模式 读 写 执行 删除 列表</li></ul></li><li>文件访问控制列表(ACL)<ul><li>&lt;文件实体, 权限&gt;</li></ul></li><li>Unix模式<ul><li>&lt;用户|组|所有人, 读|写|可执行&gt;</li><li>用户标识ID<ul><li>识别用户 表明每个用户所允许的权限及保护模式</li></ul></li><li>组标识ID<ul><li>允许用户组成组 并指定了组访问权限</li></ul></li></ul></li></ul><h5 id="语义一致性"><a href="#语义一致性" class="headerlink" title="语义一致性"></a>语义一致性</h5><p>规定多进程如何同时访问共享文件</p><ul><li>与同步算法相似</li><li>因磁盘I&#x2F;O和网络延迟而设计简单</li><li>Unix文件系统(UFS)语义(相当于把一致性问题丢回给用户自己处理)<ul><li>对打开文件的写入内容立即对其他打开同一文件的其他用户可见</li><li>共享文件指针允许多用户同时读取和写入文件</li></ul></li><li>会话语义<ul><li>写入内容只有当文件关闭时可见(一次就要写完整 效率低)</li></ul></li><li>读写锁<ul><li>一些操作系统和文件系统提供该功能(又是将一致性问题抛给用户)</li></ul></li></ul><h4 id="分层文件系统"><a href="#分层文件系统" class="headerlink" title="分层文件系统"></a>分层文件系统</h4><p>文件以目录的方式组织起来</p><ul><li>目录是一类特殊文件<ul><li>目录的内容是文件索引表&lt;文件名, 指向文件的指针&gt;</li></ul></li><li>目录和文件的树型结构<ul><li>早期的文件系统是扁平的(只有一层目录)</li></ul></li></ul><p><img data-src="/images/Hierarchical_File_System.png" alt="Hierarchical_File_System"></p><h5 id="目录操作"><a href="#目录操作" class="headerlink" title="目录操作"></a>目录操作</h5><p>操作系统应该只允许内核修改目录 以确保映射的完整性 应用程序通过系统调用访问目录</p><ul><li>搜索文件</li><li>创建文件</li><li>删除文件</li><li>列目录</li><li>重命名文件</li><li>遍历路径</li></ul><h5 id="目录实现"><a href="#目录实现" class="headerlink" title="目录实现"></a>目录实现</h5><ul><li>文件名的线性列表 包含了指向数据块的指针<ul><li>编程简单</li><li>执行搜索耗时</li></ul></li><li>哈希表<ul><li>减少目录搜索时间</li><li>冲突 两个文件名的哈希值相同</li><li>固定大小</li></ul></li></ul><h5 id="文件别名"><a href="#文件别名" class="headerlink" title="文件别名"></a>文件别名</h5><p>两个或多个文件名关联同一个文件</p><p><img data-src="/images/Alias.png" alt="Alias"></p><ul><li>硬链接<ul><li>多个文件项指向一个文件(删除操作只在最后一个指向这个文件时 才真正删除)</li></ul></li><li>软链接<ul><li>通过快捷方式指向其他文件</li><li>通过存储真实文件的逻辑名称来实现</li></ul></li></ul><h5 id="文件目录中的循环"><a href="#文件目录中的循环" class="headerlink" title="文件目录中的循环"></a>文件目录中的循环</h5><p>父目录指向子目录 子目录又指回父目录 无限循环</p><p><img data-src="/images/Directory_Loop.png" alt="Directory_Loop"></p><ul><li>解决循环的办法<ul><li>只允许到文件的链接 不允许在子目录里的链接</li><li>增加链接时 用循环检测算法确定是否合理(银行家算法 开销大)</li></ul></li><li>实际上是限制路径可遍历文件目录的长度</li></ul><h5 id="名字解析-路径遍历"><a href="#名字解析-路径遍历" class="headerlink" title="名字解析(路径遍历)"></a>名字解析(路径遍历)</h5><p>名字解析是指将逻辑名字转换成物理资源(文件)</p><ul><li>遍历文件名录直到找到目标文件</li></ul><p>当解析 <code>&quot;/bin/ls&quot;</code>时</p><ul><li>读取根目录的文件头(在磁盘固定位置)</li><li>读取根目录的数据块 搜索 <code>bin</code> 项</li><li>读取 <code>bin</code> 的文件头</li><li>读取 <code>bin</code> 的数据块 搜索 <code>ls</code> 项</li><li>读取 <code>ls</code> 的文件头</li></ul><p>当前工作目录(PWD)</p><ul><li>每个进程都会指向一个文件目录用于解析文件名(可以提高效率)</li><li>允许用户指定相对路径来代替绝对路径 如 <code>PWD=&quot;/bin”</code> 能够解析 <code>“ls”</code></li></ul><h4 id="文件系统挂载"><a href="#文件系统挂载" class="headerlink" title="文件系统挂载"></a>文件系统挂载</h4><p>文件系统需要先挂载才能被访问</p><p><img data-src="/images/Mounting_File_Systems.png" alt="Mounting_File_Systems"></p><h4 id="文件系统种类"><a href="#文件系统种类" class="headerlink" title="文件系统种类"></a>文件系统种类</h4><ul><li>磁盘文件系统<ul><li>文件存储在数据存储设备上 如磁盘</li><li>FAT NTFS ext2&#x2F;3 ISO9660</li></ul></li><li>数据库文件系统<ul><li>文件特征是可被寻址辨识的</li><li>WinFS</li></ul></li><li>日志文件系统<ul><li>记录文件系统的修改&#x2F;事件</li><li>避免操作执行到一半没执行下去的数据丢失</li></ul></li><li>网络&#x2F;分布式文件系统<ul><li>NFS SMB AFS GFS</li></ul></li><li>特殊&#x2F;虚拟文件系统<ul><li>管道</li></ul></li></ul><h5 id="网络-分布式文件系统"><a href="#网络-分布式文件系统" class="headerlink" title="网络&#x2F;分布式文件系统"></a>网络&#x2F;分布式文件系统</h5><ul><li>文件可以通过网络被共享<ul><li>文件处于远程服务器</li><li>客户端远程挂载服务器文件系统</li><li>标准系统文件访问被转换成远程访问</li><li>标准文件共享协议<ul><li>NFS for Unix</li><li>CIFS for Windows</li></ul></li></ul></li><li>分布式文件系统的挑战<ul><li>客户端和客户端上的用户辨别起来很复杂</li><li>NFS 不安全</li><li>一致性问题(更难把握)</li><li>错误处理(更难)</li></ul></li></ul><h3 id="文件系统实现"><a href="#文件系统实现" class="headerlink" title="文件系统实现"></a>文件系统实现</h3><p>分层结构</p><ul><li>虚拟(逻辑)文件系统(VFS Virtual File System)</li><li>特定文件系统模块</li></ul><p><img data-src="/images/File_system_implementation.png" alt="File_system_implementation"></p><h4 id="虚拟文件系统-VFS"><a href="#虚拟文件系统-VFS" class="headerlink" title="虚拟文件系统(VFS)"></a>虚拟文件系统(VFS)</h4><ul><li>目的<ul><li>对所有不同文件系统的抽象</li></ul></li><li>功能<ul><li>提供相同的文件和文件系统接口</li><li>管理所有文件和文件系统关联的数据结构</li><li>高效查询例程 遍历文件系统</li><li>与特定文件系统模块的交互</li></ul></li></ul><h4 id="文件系统基本数据结构"><a href="#文件系统基本数据结构" class="headerlink" title="文件系统基本数据结构"></a>文件系统基本数据结构</h4><ul><li>文件卷控制块(Unix superblock)<ul><li>每个文件系统一个</li><li>文件系统详细信息</li><li>块 块大小 空余块 计数&#x2F;指针</li></ul></li><li>文件控制块(Unix vnode or inode)<ul><li>每个文件一个</li><li>文件详细信息</li><li>访问权限 拥有者 大小 数据块位置</li></ul></li><li>目录项(Linux dentry)<ul><li>每个目录项一个(子目录或文件)</li><li>将目录项数据结构及树型布局编码成树型数据结构</li><li>每个目录项对应的文件控制块 父目录 子目录 在哪</li></ul></li></ul><h5 id="文件系统的组织视图"><a href="#文件系统的组织视图" class="headerlink" title="文件系统的组织视图"></a>文件系统的组织视图</h5><p><img data-src="/images/File_system_organization.png" alt="File_system_organization"></p><ol><li>vol文件卷控制块 指向每一个目录项 每一个目录项组织成树状结构</li><li>每一个目录项指向每一个文件</li><li>每一个文件的文件控制块知道文件里头的数据块</li></ol><h4 id="文件系统的存储结构"><a href="#文件系统的存储结构" class="headerlink" title="文件系统的存储结构"></a>文件系统的存储结构</h4><ul><li>文件系统数据结构<ul><li>卷控制块(superblock 每个文件系统一个)</li><li>文件控制块(inode 每个文件一个)</li><li>目录节点(dentry 每个目录项一个)</li></ul></li><li>以上都持久存储在外存中<ul><li>存储设备的数据块中</li></ul></li><li>当需要时加载进内存<ul><li>卷控制模块 当文件系统挂载时进入内存</li><li>文件控制块 当文件被访问时候进入内存</li><li>目录节点 在遍历一个文件路径时进入内存</li></ul></li></ul><h5 id="文件系统的存储视图"><a href="#文件系统的存储视图" class="headerlink" title="文件系统的存储视图"></a>文件系统的存储视图</h5><p><img data-src="/images/File_system_storage.png" alt="File_system_storage"></p><h3 id="多种磁盘缓存位置"><a href="#多种磁盘缓存位置" class="headerlink" title="多种磁盘缓存位置"></a>多种磁盘缓存位置</h3><p><img data-src="/images/Disk_cache.png" alt="Disk_cache"></p><ul><li>磁盘控制器 扇区缓存</li><li>内存 数据块缓存 打开文件表 内存虚拟盘(用内存来虚拟一个磁盘)</li></ul><h4 id="两种数据块缓存方式"><a href="#两种数据块缓存方式" class="headerlink" title="两种数据块缓存方式"></a>两种数据块缓存方式</h4><ul><li>数据块缓存</li><li>页缓存 统一缓存数据块和内存页</li></ul><h5 id="数据块缓存"><a href="#数据块缓存" class="headerlink" title="数据块缓存"></a>数据块缓存</h5><ul><li>数据块按需进入内存<ul><li>提供read()操作</li><li>预读 预先读取后面的数据块</li></ul></li><li>数据块使用后被缓存<ul><li>假设数据将会再次用到</li><li>写操作可能被缓存和延迟写入</li></ul></li></ul><p><img data-src="/images/Data_Block_cache.png" alt="Data_Block_cache"></p><h5 id="页缓存"><a href="#页缓存" class="headerlink" title="页缓存"></a>页缓存</h5><ul><li>虚拟页式存储<ul><li>在虚拟地址空间中虚拟页面可映射到本地外存文件中</li></ul></li><li>文件数据块的页缓存<ul><li>在虚拟内存中文件数据块被映射成页</li><li>文件的读&#x2F;写操作被转换成对内存的访问</li><li>可能导致缺页或被设置为脏页</li><li>会带来问题 页面置换算法需要协调虚拟存储和页缓存间的页面数</li></ul></li></ul><p><img data-src="/images/Page_cache_0.png" alt="Page_cache"></p><p><img data-src="/images/Page_cache_1.png" alt="Page_cache"></p><h5 id="文件系统中打开文件的数据结构"><a href="#文件系统中打开文件的数据结构" class="headerlink" title="文件系统中打开文件的数据结构"></a>文件系统中打开文件的数据结构</h5><ul><li>文件描述符<ul><li>每个被打开的文件都有一个文件描述符</li><li>文件状态信息<ul><li>目录项 当前文件指针 文件操作设置</li></ul></li></ul></li><li>打开文件表<ul><li>每个进程都有一个打开文件表</li><li>一个系统级的打开文件表</li><li>有文件被打开时 文件卷就不能被卸载</li></ul></li></ul><p><img data-src="/images/Open_file_table.png" alt="Open_file_table"></p><h5 id="打开文件锁"><a href="#打开文件锁" class="headerlink" title="打开文件锁"></a>打开文件锁</h5><p>一些文件系统提供文件锁 用于协调多进程的文件访问</p><ul><li>强制<ul><li>根据锁保持情况和访问需求确定是否拒绝访问</li></ul></li><li>劝告<ul><li>进程可以查找锁的状态来决定怎么做</li></ul></li></ul><h3 id="文件大小"><a href="#文件大小" class="headerlink" title="文件大小"></a>文件大小</h3><ul><li>大多数文件都很小<ul><li>需要对小文件提供很好的支持</li><li>数据块空间不能太大</li></ul></li><li>一些文件非常大<ul><li>必须支持大文件(64位文件偏移 考虑到文件很大 数据块大小要考虑)</li><li>大文件访问需要搞笑</li></ul></li></ul><h3 id="文件分配"><a href="#文件分配" class="headerlink" title="文件分配"></a>文件分配</h3><ul><li>分配方式<ul><li>连续分配</li><li>链式分配</li><li>索引分配</li></ul></li><li>指标<ul><li>存储效率 外部碎片(连续分配)</li><li>读写性能 访问速度</li></ul></li></ul><h4 id="连续分配"><a href="#连续分配" class="headerlink" title="连续分配"></a>连续分配</h4><p>文件头指定起始块和长度</p><p><img data-src="/images/Continuous_Allocation.png" alt="Continuous_Allocation"></p><ul><li>分配策略<ul><li>最先匹配 最佳匹配</li></ul></li><li>优点<ul><li>文件读取表现好</li><li>高效的顺序和随机访问</li></ul></li><li>缺点<ul><li>外部碎片</li><li>文件增长问题(预留几块)</li></ul></li></ul><h4 id="链式分配"><a href="#链式分配" class="headerlink" title="链式分配"></a>链式分配</h4><p>文件以数据块链表方式存储 文件头包含了第一块和最后一块的指针</p><p><img data-src="/images/Linked_Allocation.png" alt="Linked_Allocation"></p><ul><li>优点<ul><li>创建 增大 缩小很容易</li><li>没有外部碎片</li></ul></li><li>缺点<ul><li>无法实现真正的随机访问</li><li>可靠性差 破坏一个链 后面的数据块就丢了</li></ul></li></ul><h4 id="索引分配"><a href="#索引分配" class="headerlink" title="索引分配"></a>索引分配</h4><p>为每个文件创建一个索引数据块(存于文件头中) 指向文件数据块的指针列表</p><p><img data-src="/images/Indexed_Allocation.png" alt="Indexed_Allocation"></p><ul><li>优点<ul><li>创建 增大 缩小很容易</li><li>没有外部碎片</li><li>支持直接访问</li></ul></li><li>缺点<ul><li>当文件很小时 存储索引的开销(浪费多一块数据块)</li><li>当文件很大 索引数据块存不下索引号 只能再加索引数据块</li></ul></li></ul><h5 id="大文件的索引分配"><a href="#大文件的索引分配" class="headerlink" title="大文件的索引分配"></a>大文件的索引分配</h5><p>链式索引块(IB + IB + …)</p><p><img data-src="/images/Link_Index_Allocation.png" alt="Link_Index_Allocation"></p><p>多级索引块(IB * IB * …)</p><p><img data-src="/images/Multilevel_Index_Allocation.png" alt="Multilevel_Index_Allocation"></p><h4 id="UFS多级索引分配-UFS-Unix-File-System"><a href="#UFS多级索引分配-UFS-Unix-File-System" class="headerlink" title="UFS多级索引分配(UFS Unix File System)"></a>UFS多级索引分配(UFS Unix File System)</h4><p>将各种分配方法集合到一起</p><p><img data-src="/images/Unix_file_system.png" alt="Unix_file_system"></p><ul><li>文件头包含13个指针<ul><li>10个指针指向数据块</li><li>第1个指针指向索引块</li><li>第12个指针指向二级索引快</li><li>第13个指针指向三级索引快</li></ul></li><li>效果<ul><li>提高了文件大小限制阈值</li><li>动态分配数据块 文件扩展很容易</li><li>小文件开销小</li><li>只为大文件分配间接索引块 大文件在访问数据块时需要大量查询</li></ul></li></ul><h3 id="空闲空间管理"><a href="#空闲空间管理" class="headerlink" title="空闲空间管理"></a>空闲空间管理</h3><p>跟踪记录文件卷中未分配的数据块</p><h4 id="位图-组织空闲空间"><a href="#位图-组织空闲空间" class="headerlink" title="位图 组织空闲空间"></a>位图 组织空闲空间</h4><p>用位图代表空闲数据块列表</p><ul><li>Di &#x3D; 0 表明数据块i为空闲 否则 表示已分配</li><li>使用简单 但是可能会是一个很大的向量表<ul><li>160GB磁盘-&gt;40M数据块(假设4kb为一块)-&gt;5MB位图</li></ul></li><li>假定空闲空间在磁盘中均匀分布 则找到 空闲块之前要扫描 n&#x2F;r<ul><li>n &#x3D; 磁盘上数据块的总数</li><li>r &#x3D; 空闲块的数目(空闲块占的越多 越容易找到)</li></ul></li></ul><h3 id="磁盘分区"><a href="#磁盘分区" class="headerlink" title="磁盘分区"></a>磁盘分区</h3><p>通常磁盘通过分区来最大限度减少寻道时间</p><ul><li>分区是一组柱面的集合</li><li>每个分区都可视为逻辑上独立的磁盘</li></ul><p><img data-src="/images/Disk_partitioning.png" alt="Disk_partitioning"></p><h3 id="多磁盘管理"><a href="#多磁盘管理" class="headerlink" title="多磁盘管理"></a>多磁盘管理</h3><p>使用多磁盘可改善</p><ul><li>吞吐量(通过并行)</li><li>可靠性和可用性(通过冗余)</li></ul><h3 id="冗余磁盘阵列-RAID-Redundant-Array-of-Inexpensive-Disks"><a href="#冗余磁盘阵列-RAID-Redundant-Array-of-Inexpensive-Disks" class="headerlink" title="冗余磁盘阵列(RAID Redundant Array of Inexpensive Disks)"></a>冗余磁盘阵列(RAID Redundant Array of Inexpensive Disks)</h3><ul><li>多种磁盘管理技术</li><li>RAID-0 RAID-1 RAID-4 RAID-5</li></ul><h4 id="冗余磁盘阵列的实现"><a href="#冗余磁盘阵列的实现" class="headerlink" title="冗余磁盘阵列的实现"></a>冗余磁盘阵列的实现</h4><ul><li>软件<ul><li>操作系统内核的文件卷管理</li></ul></li><li>硬件<ul><li>RAID硬件控制器(I&#x2F;O)</li></ul></li></ul><h4 id="RAID-0-磁盘条带化"><a href="#RAID-0-磁盘条带化" class="headerlink" title="RAID-0(磁盘条带化)"></a>RAID-0(磁盘条带化)</h4><p>把数据块分成多个子块 存储在独立的磁盘上(就是分开存) 基于数据块</p><ul><li>通过独立磁盘上并行数据块访问提供更大的磁盘带宽</li></ul><p><img data-src="/images/RAID_0.png" alt="RAID_0"></p><h4 id="RAID-1-磁盘镜像"><a href="#RAID-1-磁盘镜像" class="headerlink" title="RAID-1(磁盘镜像)"></a>RAID-1(磁盘镜像)</h4><p>向两个磁盘写入 从任何一个读取(就是存多份)</p><ul><li>可靠性成倍增长</li><li>读取性能线性增加</li></ul><p><img data-src="/images/RAID_1.png" alt="RAID_1"></p><h4 id="RAID-4-带校验的磁盘条带化"><a href="#RAID-4-带校验的磁盘条带化" class="headerlink" title="RAID-4(带校验的磁盘条带化)"></a>RAID-4(带校验的磁盘条带化)</h4><p>数据块级的磁盘条带化加专用奇偶校验磁盘(就是分开存 校验磁盘单独存) 基于数据块</p><ul><li>允许从任意一个故障磁盘中恢复</li></ul><p><img data-src="/images/RAID_4.png" alt="RAID_4"></p><h4 id="RAID-5-带分布式校验的磁盘条带化"><a href="#RAID-5-带分布式校验的磁盘条带化" class="headerlink" title="RAID-5(带分布式校验的磁盘条带化)"></a>RAID-5(带分布式校验的磁盘条带化)</h4><p>把校验和数据块分摊到各个磁盘上 减少对校验和的磁盘的读写压力(就是分开存 同时校验磁盘也分开存) 基于数据块<br>只有 RAID-3 基于位</p><p><img data-src="/images/RAID_5.png" alt="RAID_5"></p><h5 id="可纠正多个磁盘错误的冗余磁盘阵列"><a href="#可纠正多个磁盘错误的冗余磁盘阵列" class="headerlink" title="可纠正多个磁盘错误的冗余磁盘阵列"></a>可纠正多个磁盘错误的冗余磁盘阵列</h5><ul><li>RAID-5 每组条带块有一个奇偶校验快<ul><li>允许一个磁盘错误</li></ul></li><li>RAID-6 每组条带块有两个冗余块<ul><li>允许两个磁盘错误</li></ul></li></ul><h5 id="RAID嵌套"><a href="#RAID嵌套" class="headerlink" title="RAID嵌套"></a>RAID嵌套</h5><ul><li>RAID 0 + 1(条带化提高性能 再做一个磁盘镜像 可靠性提高)</li></ul><p><img data-src="/images/RAID_0+1.png" alt="RAID_0+1"></p><ul><li>RAID 1 + 0(先做磁盘镜像 再做条带化)</li></ul><p><img data-src="/images/RAID_1+0.png" alt="RAID_1+0"></p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" rel="tag"># 操作系统</a> <a href="/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" rel="tag"># 文件系统</a> <a href="/tags/%E5%86%97%E4%BD%99%E7%A3%81%E7%9B%98%E9%98%B5%E5%88%97/" rel="tag"># 冗余磁盘阵列</a></div><div class="post-nav"><div class="post-nav-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B-%E6%AD%BB%E9%94%81%E5%92%8C%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1/" rel="prev" title="操作系统之 死锁和进程通信"><i class="fa fa-angle-left"></i> 操作系统之 死锁和进程通信</a></div><div class="post-nav-item"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-uCore-Lab-8/" rel="next" title="操作系统 uCore Lab 8">操作系统 uCore Lab 8 <i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Yuerer</span></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><div class="reading-progress-bar"></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://unpkg.com/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://unpkg.com/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="https://s4.zstatic.net/ajax/libs/hexo-theme-next/8.21.1/comments.min.js"></script><script src="https://s4.zstatic.net/ajax/libs/hexo-theme-next/8.21.1/utils.min.js"></script><script src="https://s4.zstatic.net/ajax/libs/hexo-theme-next/8.21.1/motion.min.js"></script><script src="https://s4.zstatic.net/ajax/libs/hexo-theme-next/8.21.1/sidebar.min.js"></script><script src="https://s4.zstatic.net/ajax/libs/hexo-theme-next/8.21.1/next-boot.min.js"></script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://yuerer-comment-xufei-0bea01e6f05-1307930306.ap-shanghai.app.tcloudbase.com","cssUrl":"https://s4.zstatic.net/ajax/libs/waline/2.15.8/waline.css","commentCount":true,"pageview":true,"libUrl":"https://s4.zstatic.net/ajax/libs/waline/2.15.8/waline.js","locale":{"placeholder":"有何高见？"},"emoji":["https://unpkg.com/@waline/emojis@1.0.1/qq"],"meta":["nick","mail"],"requiredMeta":[["nick","mail"]],"wordLimit":0,"login":"disable","pageSize":10,"el":"#waline","comment":true,"path":"/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"}</script><link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/waline/2.15.8/waline.css"><script>document.addEventListener("page:loaded",()=>{NexT.utils.loadComments(CONFIG.waline.el).then(()=>NexT.utils.getScript(CONFIG.waline.libUrl,{condition:window.Waline})).then(()=>Waline.init(Object.assign({},CONFIG.waline,{el:document.querySelector(CONFIG.waline.el)})))})</script></body></html>